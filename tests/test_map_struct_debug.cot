// Minimal test for map with large struct values

struct Data {
    name: string,      // 16 bytes (offset 0)
    field1: u32,       // 4 bytes (offset 16)
    field2: u32,       // 4 bytes (offset 20)
}

fn main() int {
    var map: Map<string, Data> = new Map<string, Data>()

    var val: Data = Data{
        .name = "test",
        .field1 = 111,
        .field2 = 222,
    }

    // Check val before storing
    if val.field1 != 111 {
        return 10
    }
    if val.field2 != 222 {
        return 11
    }

    map.set("key", val)

    if not map.has("key") {
        return 1
    }

    var found: Data = map.get("key")

    // Return field1's value if not 111 (tells us what we got)
    if found.field1 != 111 {
        return 20  // field1 is wrong
    }

    if found.field2 != 222 {
        return 30  // field2 is wrong
    }

    return 42
}
